<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Th∆∞ vi·ªán S√°ch</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .container { margin-top: 30px; }
        .pagination-controls { margin-top: 20px; }
        .message-success { color: green; font-weight: bold; }
        .message-error { color: red; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h1 class="mb-4">üìã Th∆∞ Vi·ªán S√°ch </h1>
    <p><a href="/return">ƒêi t·ªõi trang Tr·∫£ S√°ch</a> | <a href="/book-borrow">Xem danh s√°ch ƒëang m∆∞·ª£n</a></p>
    <hr>

    <div th:if="${param.code}" class="alert alert-success message-success">
        ‚úÖ M∆∞·ª£n s√°ch th√†nh c√¥ng! M√£ m∆∞·ª£n c·ªßa b·∫°n l√†: <strong th:text="${param.code}"></strong>. Vui l√≤ng gi·ªØ m√£ n√†y ƒë·ªÉ tr·∫£ s√°ch.
    </div>
    <div th:if="${successMessage}" class="alert alert-info message-success">
        üéâ <strong th:text="${successMessage}"></strong>
    </div>
    <div th:if="${error}" class="alert alert-danger message-error">
        ‚ùå <span th:text="${error}"></span>
    </div>

    <form action="/book" method="get" class="row mb-4">
        <div class="col-md-4">
            <input type="text" name="searchName" th:value="${searchName}" class="form-control" placeholder="T√¨m ki·∫øm theo t√™n s√°ch...">
        </div>
        <div class="col-md-2">
            <button type="submit" class="btn btn-primary">T√¨m ki·∫øm</button>
        </div>
    </form>

    <table class="table table-bordered table-striped">
        <thead>
        <tr>
            <th>STT</th>
            <th>Ti√™u ƒë·ªÅ (Title)</th>
            <th>T√°c gi·∫£ (Author)</th>
            <th>S·ªë l∆∞·ª£ng c√≤n l·∫°i</th>
            <th>H√†nh ƒë·ªông</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="book,status:${bookPage.content}">
            <td th:text="${status.count}"></td>
            <td th:text="${book.title}"></td>
            <td th:text="${book.author}"></td>
            <td>
                <span th:text="${book.quantity}"></span>
                <span th:if="${book.quantity == 0}" class="badge bg-danger">H·∫æT</span>
            </td>
            <td>
                <a th:if="${book.quantity > 0}" th:href="@{/borrow(id=${book.id})}" class="btn btn-sm btn-success">M∆∞·ª£n S√°ch</a>
                <button th:unless="${book.quantity > 0}" class="btn btn-sm btn-secondary" disabled>H·∫øt s√°ch</button>
            </td>
        </tr>
        </tbody>
    </table>

    <div class="pagination-controls text-center">
        <a th:if="${bookPage.hasPrevious()}"
           th:href="@{/book(page=${bookPage.number - 1}, size=${bookPage.size}, searchName=${searchName})}"
           class="btn btn-info">Tr∆∞·ªõc</a>

        <span class="mx-3">Trang <span th:text="${bookPage.number + 1}"></span> / <span th:text="${bookPage.totalPages}"></span></span>

        <a th:if="${bookPage.hasNext()}"
           th:href="@{/book(page=${bookPage.number + 1}, size=${bookPage.size}, searchName=${searchName})}"
           class="btn btn-info">Sau</a>
    </div>
</div>

</body>
</html>